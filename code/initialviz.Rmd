---
title: "initial visualization of biomarker data"
authors: Chris M
date: February 20, 2024
---

#load packages
```{r}
#install.packages("vctrs")
library(tidyr)
library(tidyverse)
library(ggplot2)
library(vegan)

```

#load data
#biomarkersbysite= p450 and SOD by site
#morphometrics= weight, length, height, and width measurements
#shellthickness= shell thickness measurements
```{r}
data<- read.csv("data/biomarkerswithsites.csv", header= TRUE, sep=",")
morph<- read.csv("data/morphometrics.csv", header= TRUE, sep=",")
thick<- read.csv("data/shellthickness.csv", header= TRUE, sep=",")

```

#inspect data
```{r}
str(data)
```

#inspect data
```{r}
summary(data)
```
#inspect morph
#distance measured in mm + weight measured in g
```{r}
summary(morph)
```

#inspect thick
#fix data types for measurement categories + include mm as unit of measurement
#throw out the 0's?
```{r}
summary(thick)
```

#plot SOD by site
```{r}
#loop 
for (site in 1:77) {
  # Filter the data for the current site
  sodsite_df <- data[data$site_number == site, ]
  
  # Plot the bar chart for the current site
  p <- ggplot(sodsite_df, aes(x = factor(sample), y = SOD)) +
    geom_bar(stat = "identity") +
    labs(x = "Individual Sample", y = "SOD Value") +
    ggtitle(paste("SOD Values for Site", site, "by Individual Sample"))
  
  # Print the plot
  print(p)
}
```

#plot p450 by site
```{r}
#individual
# Example for site 21 
#site21_df <- df[df$site_number == 21, ]

#ggplot(site21_df, aes(x = factor(sample), y = p450)) +
  #geom_bar(stat = "identity") +
  #labs(x = "Individual Sample", y = "p450 Value") +
  #ggtitle("p450 Values for Site 21 by Individual Sample")


#loop
# Loop through each site from 1 to 77
for (site in 1:77) {
  # Filter the data for the current site
  psite_df <- data[data$site_number == site, ]
  
  # Check if there are samples for the current site
  if (nrow(psite_df) > 0) {
    # Plot the bar chart for the current site
    p <- ggplot(psite_df, aes(x = factor(sample), y = p450)) +
      geom_bar(stat = "identity") +
      labs(x = "Individual Sample", y = "p450 Value") +
      ggtitle(paste("p450 Values for Site", site, "by Individual Sample"))
    
    # Print the plot
    print(p)
  }
}
```


#ANOVA
```{r}
# Variation within each site for SOD and p450
sod_variation <- aggregate(SOD ~ site_number, data = data, var)
print(sod_variation)
p450_variation <- aggregate(p450 ~ site_number, data = data, var)

# ANOVA for site and SOD
anova_sod <- aov(SOD ~ factor(site_number), data = data)
summary(anova_sod)

# ANOVA for site and p450
anova_p450 <- aov(p450 ~ factor(site_number), data = data)
summary(anova_p450)

# ANOVA for SOD and p450
anova_sod_p450 <- aov(SOD ~ p450, data = data)
summary(anova_sod_p450)


#site and biomarkers are statistically relevant co-factors, but the biomarkers aren't statistically significant to each other.
#try to understand the variation stuff, it feels incorrect

```

#pca
#correlation plot
#combine condition factor, economic facotr + data for correlation and pca?






