---
title: "070- Multiple Regression Models"
output:
  html_document: 
    toc: true
    toc_float:
        collapsed: false
        smooth_scroll: true
    fig_width: 20
  pdf_document: 
    fig_width: 20
    fig_height: 9
---

# Directory and doc rules

```{r, setup, eval=TRUE, include=TRUE}

knitr::opts_chunk$set(
  echo = TRUE,         # Display code chunks
  eval = TRUE,         # Evaluate code chunks
  warning = FALSE,     # Hide warnings
  message = FALSE,     # Hide messages
  fig.width = 20,       # Set plot width in inches
  fig.height = 9,      # Set plot height in inches
  fig.align = "center" # Align plots to the center
)

```

# Load data
```{r}
data<- read.csv("/Users/cmantegna/Documents/WDFWmussels/data/p450correlationMAN.csv")
sdata<- read.csv("/Users/cmantegna/Documents/WDFWmussels/data/sodcorrelationMAN1.csv")
ssdata<- read.csv("/Users/cmantegna/Documents/WDFWmussels/data/sodcorrelationMAN2.csv")
mdata<- read.csv("/Users/cmantegna/Documents/WDFWmussels/data/avgMORPH_analytes.csv")

```

```{r}

# Load necessary libraries
library(tidyverse)
library(broom)  # For tidy model summaries
library(ggplot2)

# Define the regression model with interactions for latitude and analytes
model <- lm(avg_p450 ~ latitude * sum40CB + latitude * sumBDE + latitude * sumCHLD +
                       longitude * sum40CB + longitude * sumBDE + longitude * sumCHLD,
            data = data)

# Get a tidy summary with confidence intervals
model_summary <- tidy(model, conf.int = TRUE)

# Plot coefficients with ggplot
ggplot(model_summary, aes(x = estimate, y = term)) +
  geom_point(color = "blue") +
  geom_errorbarh(aes(xmin = conf.low, xmax = conf.high), height = 0.2, color = "gray") +
  geom_vline(xintercept = 0, linetype = "dashed", color = "red") +
  labs(title = "Coefficient Plot with Confidence Intervals for avg_p450 Model",
       x = "Coefficient Value", y = "Predictor (Main Effects & Interactions)") +
  theme_minimal()

```

```{r}

```

