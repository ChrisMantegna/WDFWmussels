---
title: "010- p450 tests for significance and correlation"
output:
  pdf_document: 
    fig_width: 20
    fig_height: 9
  html_document: 
    toc: true
    toc_float:
        collapsed: false
        smooth_scroll: true
    fig_width: 20
---

# Directory and doc rules

```{r, setup, eval=TRUE, include=TRUE}

knitr::opts_chunk$set(
  echo = TRUE,         # Display code chunks
  eval = TRUE,         # Evaluate code chunks
  warning = FALSE,     # Hide warnings
  message = FALSE,     # Hide messages
  fig.width = 20,       # Set plot width in inches
  fig.height = 9,      # Set plot height in inches
  fig.align = "center" # Align plots to the center
)

```

# Load packages

```{r}
library(tinytex)
library(tidyr)
library(tidyverse)
library(vegan)

```

# Load data

```{r}

#getwd()
pdata<- read.csv("/Users/cmantegna/Documents/WDFWmussels/data/p450data.csv")
p_indvdata<- read.csv("/Users/cmantegna/Documents/WDFWmussels/data/avgP450_analytes.csv")
p_sumdata<- read.csv("/Users/cmantegna/Documents/WDFWmussels/data/avgP450_analytes2.csv")
```

# Check data

```{r}
#summary(pdata)
```

# Shapiro-Wilkes

```{r}

#test for normality. No data is normally distributed.

shapiro.test(pdata$p450)
#shapiro.test(apdata$sumPAH)
#shapiro.test(apdata$lmwPAH)
#shapiro.test(apdata$hmwPAH)
#shapiro.test(apdata$PAH16)
#shapiro.test(apdata$sumPCB)
#shapiro.test(apdata$mercury)
#shapiro.test(apdata$arsenic)
#shapiro.test(apdata$cadmium)
#shapiro.test(apdata$copper)
#shapiro.test(apdata$lead)
#shapiro.test(apdata$zinc)

```

# Kruskal-Wallis
## site and reporting area
```{r}

#test for significant interaction

# Change to character for the kw test 
pdata$PAHgroup <- as.character(pdata$PAHgroup3)
pdata$PAHgroup2 <- as.character(pdata$PAHgroup4)

kruskal.test(p450 ~ site_name, data = pdata)
kruskal.test(p450 ~ reporting_area, data = pdata)
kruskal.test(p450 ~ PAHgroup3, data = pdata)
kruskal.test(p450 ~ PAHgroup4, data = pdata)

```

## PAH groups
```{r}

pdata$PAHgroup3 <- as.character(pdata$PAHgroup5)
pdata$PAHgroup3 <- as.character(pdata$PAHgroup6)
pdata$PAHgroup3 <- as.character(pdata$PAHgroup7)
pdata$PAHgroup3 <- as.character(pdata$PAHgroup8)

kruskal.test(p450 ~ PAHgroup5, data = pdata)
kruskal.test(p450 ~ PAHgroup6, data = pdata)
kruskal.test(p450 ~ PAHgroup7, data = pdata)
kruskal.test(p450 ~ PAHgroup8, data = pdata)
```

# Kruskal-Wallac Multiple Comparisons (post hoc)

Reporting Areas Are:\
6 - East Juan de Fuca Strait\
7 - San Juan Islands\
8.1 - Deception Pass, Hope Island, and Skagit Bay\
8.2 - Port Susan and Port Gardner\
9 - Admiralty Inlet\
10 - Seattle-Bremerton\
11 - Tacoma-Vashon\
12 - Hood Canal\
13 - South Puget Sound

```{r}
library(pgirmess)

# no significance confirmed between sites
# significant differences across reporting area pairwise matches: 8.2-12, 10-13, 11-12, and 12-13
# significant differences across PAHgroup7 pairwise comparisons
# significant differences across PAHgroup8 pairwise comparisons

mc_site<- as.data.frame(kruskalmc(p450 ~ site_name, data = pdata, method = "bonferroni"))

mc_reporting<- as.data.frame(kruskalmc(p450 ~ reporting_area, data = pdata, method = "bonferroni"))
write.csv(mc_reporting, "/Users/cmantegna/Documents/WDFWmussels/output/tables/Significantp450RA.csv", row.names = FALSE)

mc_group7<- as.data.frame(kruskalmc(p450 ~ PAHgroup7, data = pdata, method = "bonferroni"))
write.csv(mc_group7, "/Users/cmantegna/Documents/WDFWmussels/output/tables/Significantp450group7.csv", row.names = FALSE)

mc_group8<- as.data.frame(kruskalmc(p450 ~ PAHgroup8, data = pdata, method = "bonferroni"))
write.csv(mc_group8, "/Users/cmantegna/Documents/WDFWmussels/output/tables/Significantp450group8.csv", row.names = FALSE)

#head(mc_site)
#head(mc_reporting)

```

# Correlation
## sumPAH, lmwPAH, hmwPAH and PAH16

```{r}

# no correlation
correlation_result <- cor.test(p_sumdata$p450, p_sumdata$sumPAH, method = "pearson")
print(correlation_result)

# no correlation
correlation_result <- cor.test(p_sumdata$p450, p_sumdata$hmwPAH, method = "pearson")
print(correlation_result)

# no correlation
correlation_result <- cor.test(p_sumdata$p450, p_sumdata$lmwPAH, method = "pearson")
print(correlation_result)

# no correlation
correlation_result <- cor.test(p_sumdata$p450, p_sumdata$PAH16, method = "pearson")
print(correlation_result)

```

## sum42PAH and sumPCB

```{r}

#no correlation
correlation_result <- cor.test(p_sumdata$p450, p_sumdata$PAH16, method = "pearson")
print(correlation_result)

#no correlation
correlation_result <- cor.test(p_sumdata$p450, p_sumdataapdata$p450, apdata$sumPCB, method = "pearson")
print(correlation_result)

```

## mercury, arsenic, cadmium, copper, lead and zinc

```{r}

# Correlation of .1505; p-value= .0092
correlation_result <- cor.test(apdata$p450, apdata$mercury, method = "pearson")
print(correlation_result)

# no correlation
correlation_result <- cor.test(apdata$p450, apdata$arsenic, method = "pearson")
print(correlation_result)

# no correlation
correlation_result <- cor.test(apdata$p450, apdata$cadmium, method = "pearson")
print(correlation_result)

# no correlation
correlation_result <- cor.test(apdata$p450, apdata$copper, method = "pearson")
print(correlation_result)

# no correlation
correlation_result <- cor.test(apdata$p450, apdata$lead, method = "pearson")
print(correlation_result)

# no correlation
correlation_result <- cor.test(apdata$p450, apdata$zinc, method = "pearson")
print(correlation_result)

```

## other summed analytes

```{r}

# no correlation
correlation_result <- cor.test(pdata$p450, pdata$Sum40CBs, method = "pearson")
print(correlation_result)

# no correlation
correlation_result <- cor.test(pdata$p450, pdata$SumBDEs, method = "pearson")
print(correlation_result)

# no correlation
correlation_result <- cor.test(pdata$p450, pdata$SumCHLDs, method = "pearson")
print(correlation_result)

# no correlation
correlation_result <- cor.test(pdata$p450, pdata$SumDDTs, method = "pearson")
print(correlation_result)

# no correlation
correlation_result <- cor.test(pdata$p450, pdata$SumHCHs, method = "pearson")
print(correlation_result)

```
