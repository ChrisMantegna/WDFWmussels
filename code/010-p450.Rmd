---
title: "010- p450 tests for significance and correlation"
output:
  html_document: 
    toc: true
    toc_float:
        collapsed: false
        smooth_scroll: true
    fig_width: 20
  pdf_document: 
    fig_width: 20
    fig_height: 9
---

# Directory and doc rules

```{r, setup, eval=TRUE, include=TRUE}

knitr::opts_chunk$set(
  echo = TRUE,         # Display code chunks
  eval = TRUE,         # Evaluate code chunks
  warning = FALSE,     # Hide warnings
  message = FALSE,     # Hide messages
  fig.width = 20,       # Set plot width in inches
  fig.height = 9,      # Set plot height in inches
  fig.align = "center" # Align plots to the center
)

```

# Load packages

```{r}
library(tinytex)
library(tidyr)
library(tidyverse)
library(vegan)

```

# Load data

```{r}

#getwd()
#pdata<- read.csv("/Users/cmantegna/Documents/WDFWmussels/data/p450data.csv")
apdata<- read.csv("/Users/cmantegna/Documents/WDFWmussels/data/p450_analytes.csv")

#metal<- read.csv("/Users/cmantegna/Documents/WDFWmussels/data/metals.csv")

```

# Check data

```{r}
summary(apdata)
quantiles <- quantile(apdata$sumPAH, probs = c(1/3, 2/3))
print(quantiles)
```

# Shapiro-Wilkes

```{r}

#test for normality. No data is normally distributed.

shapiro.test(apdata$p450)
shapiro.test(apdata$sumPAH)
shapiro.test(apdata$lmwPAH)
shapiro.test(apdata$hmwPAH)
shapiro.test(apdata$PAH16)
shapiro.test(apdata$sumPCB)
shapiro.test(apdata$mercury)
shapiro.test(apdata$arsenic)
shapiro.test(apdata$cadmium)
shapiro.test(apdata$copper)
shapiro.test(apdata$lead)
shapiro.test(apdata$zinc)

```

# Kruskal-Wallis

```{r}

#test for significant interaction

# Change to character for the kw test AFTER keeping as numeric for the correlation tests - if necessary
#apdata$PAHgroup <- as.character(apdata$PAHgroup)
#apdata$PAHgroup2 <- as.character(apdata$PAHgroup2)
#apdata$PAHgroup3 <- as.character(apdata$PAHgroup3)

kruskal.test(p450 ~ site_name, data = apdata)
kruskal.test(p450 ~ reporting_area, data = apdata)
kruskal.test(p450 ~ PAHgroup, data = apdata)
kruskal.test(p450 ~ PAHgroup2, data = apdata)
kruskal.test(p450 ~ PAHgroup3, data = apdata)

```

# Kruskal-Wallac Multiple Comparisons (post hoc)

Reporting Areas Are:\
6 - East Juan de Fuca Strait\
7 - San Juan Islands\
8.1 - Deception Pass, Hope Island, and Skagit Bay\
8.2 - Port Susan and Port Gardner\
9 - Admiralty Inlet\
10 - Seattle-Bremerton\
11 - Tacoma-Vashon\
12 - Hood Canal\
13 - South Puget Sound

```{r}
library(pgirmess)

# no significance confirmed between sites
# significant differences across reporting area pairwise matches: 8.2-12, 10-13, 11-12, and 12-13

mc_site<- as.data.frame(kruskalmc(p450 ~ site_name, data = apdata, method = "bonferroni"))
mc_reporting<- as.data.frame(kruskalmc(p450 ~ reporting_area, data = apdata, method = "bonferroni"))

#head(mc_site)
#head(mc_reporting)

```

# Correlation- PAHgroup, PAHgroup2 and PAHgroup3

1= Low\
2= Mid\
3= High\
4= Very High\
PAHgroup= broken into 3rds by quantile in chunk 55-59\
PAHgroup2= broken into quarters manually by vibes\
PAHgroup3= broken into quarters by quartiles listed in data summary in chunk 55-59

```{r}

#no correlation
correlation_result <- cor.test(apdata$p450, apdata$PAHgroup, method = "pearson")
print(correlation_result)

#no correlation
correlation_result <- cor.test(apdata$p450, apdata$PAHgroup2, method = "pearson")
print(correlation_result)

#no correlation
correlation_result <- cor.test(apdata$p450, apdata$PAHgroup3, method = "pearson")
print(correlation_result)
```

# Correlation- sumPAH, lmwPAH, hmwPAH and PAH16

```{r}

# no correlation
correlation_result <- cor.test(apdata$p450, apdata$sumPAH, method = "pearson")
print(correlation_result)

# no correlation
correlation_result <- cor.test(apdata$p450, apdata$hmwPAH, method = "pearson")
print(correlation_result)

# no correlation
correlation_result <- cor.test(apdata$p450, apdata$lmwPAH, method = "pearson")
print(correlation_result)

# no correlation
correlation_result <- cor.test(apdata$p450, apdata$PAH16, method = "pearson")
print(correlation_result)

```

# Correlation test - sumPCB

```{r}

# no correlation
correlation_result <- cor.test(apdata$p450, apdata$sumPCB, method = "pearson")
print(correlation_result)

```

# Correlation test - mercury, arsenic, cadmium, copper, lead and zinc

```{r}

# Correlation of .1505; p-value= .0092
correlation_result <- cor.test(apdata$p450, apdata$mercury, method = "pearson")
print(correlation_result)

# no correlation
correlation_result <- cor.test(apdata$p450, apdata$arsenic, method = "pearson")
print(correlation_result)

# no correlation
correlation_result <- cor.test(apdata$p450, apdata$cadmium, method = "pearson")
print(correlation_result)

# no correlation
correlation_result <- cor.test(apdata$p450, apdata$copper, method = "pearson")
print(correlation_result)

# no correlation
correlation_result <- cor.test(apdata$p450, apdata$lead, method = "pearson")
print(correlation_result)

# no correlation
correlation_result <- cor.test(apdata$p450, apdata$zinc, method = "pearson")
print(correlation_result)

```
