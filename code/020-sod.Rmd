---
title: "020- SOD tests for significance and correlation"
output:
  pdf_document: 
    fig_width: 20
    fig_height: 9
  html_document: 
    toc: true
    toc_float:
        collapsed: false
        smooth_scroll: true
    fig_width: 20
---

# Directory and doc rules

```{r, setup, eval=TRUE, include=TRUE}

knitr::opts_chunk$set(
  echo = TRUE,         # Display code chunks
  eval = TRUE,         # Evaluate code chunks
  warning = FALSE,     # Hide warnings
  message = FALSE,     # Hide messages
  fig.width = 20,       # Set plot width in inches
  fig.height = 9,      # Set plot height in inches
  fig.align = "center" # Align plots to the center
)

```

# Load packages

```{r}
library(tinytex)
library(tidyr)
library(tidyverse)
library(vegan)

```

# Load data

```{r}

#getwd()
sdata<- read.csv("/Users/cmantegna/Documents/WDFWmussels/data/sod_analytes3.csv")
asdata<- read.csv("/Users/cmantegna/Documents/WDFWmussels/data/sod_analytes.csv")

```

```{r}

# Data contains numbers below 0 that must be adjusted.These numbers represent samples whose values were below the limit of quantification using the SOD kit. There was some activity in the raw sample, but it is too far below the limit of the standard curve to be accurately quantified.


#replace any SOD values at or below 0 with half of the lower detection limit of .005 (.005*.5). Lower detection limit determined by assay protocol by the manufacturer, Cayman.
asdata$sod[asdata$sod <= 0] <- 0.0025
sdata$sod[sdata$sod <= 0] <- 0.0025

```
# Check data

```{r}
summary(sdata)
```

# Shapiro-Wilkes 
```{r}

#test for normality. Data is not normally distributed.
# *All analytes were determined not normally distributed in 010-p450.Rmd* 

shapiro.test(asdata$sod)

```

# Kruskal-Wallis
## site and reporting area

```{r}

#test for significant interaction

# Change to character for the kw test AFTER keeping as numeric for the correlation tests - if necessary
#apdata$PAHgroup <- as.character(apdata$PAHgroup)
#apdata$PAHgroup2 <- as.character(apdata$PAHgroup2)
#apdata$PAHgroup3 <- as.character(apdata$PAHgroup3)

kruskal.test(sod ~ site_name, data = asdata)
kruskal.test(sod ~ reporting_area, data = asdata)


```

## PAH groups
```{r}

kruskal.test(sod ~ PAHgroup3, data = asdata)
kruskal.test(sod ~ PAHgroup4, data = asdata)
kruskal.test(sod ~ PAHgroup5, data = asdata)
kruskal.test(sod ~ PAHgroup6, data = asdata)

```

# Kruskal-Wallac Multiple Comparisons (post hoc)

Reporting Areas Are:\
6 - East Juan de Fuca Strait\
7 - San Juan Islands\
8.1 - Deception Pass, Hope Island, and Skagit Bay\
8.2 - Port Susan and Port Gardner\
9 - Admiralty Inlet\
10 - Seattle-Bremerton\
11 - Tacoma-Vashon\
12 - Hood Canal\
13 - South Puget Sound

```{r}
library(pgirmess)

# no significance confirmed between sites
# significance confirmed between low(1) and very high(4)

mc_site<- as.data.frame(kruskalmc(sod ~ site_name, data = asdata, method = "bonferroni"))
mc_group4<- as.data.frame(kruskalmc(sod ~ PAHgroup4, data = asdata, method = "bonferroni")) 

head(mc_site)
head(mc_group4)

```

# Correlations
## PAHgroup3, PAHgroup4, PAHgroup5 and PAHgroup6
0= VLow\
1= Low\
2= Mid\
3= High\
4= VHigh\
5= EHigh
PAH groups determined by set quantiles found in grouping.rmd.\
Group3= 1-3 | Group4= 1-4 | Group5= 0-4 | Group6= 0-5
```{r}

# no correlation
correlation_result <- cor.test(asdata$sod, asdata$PAHgroup3, method = "pearson")
print(correlation_result)

# correlation= 0.1774695 with a p-value= 0.001677 indicates a weak positive correlation.
correlation_result <- cor.test(asdata$sod, asdata$PAHgroup4, method = "pearson")
print(correlation_result)

# correlation= 0.1351344 with a p-value= 0.0171 indicates a weak positive correlation.
correlation_result <- cor.test(asdata$sod, asdata$PAHgroup5, method = "pearson")
print(correlation_result)

# correlation= 0.132161 with a p-value= 0.01973 indicates a weak positive correlation.
correlation_result <- cor.test(asdata$sod, asdata$PAHgroup6, method = "pearson")
print(correlation_result)

```


## sumPAH, lmwPAH, hmwPAH and PAH16
```{r}

# no correlation
correlation_result <- cor.test(asdata$sod, asdata$sumPAH, method = "pearson")
print(correlation_result)

# no correlation
correlation_result <- cor.test(asdata$sod, asdata$lmwPAH, method = "pearson")
print(correlation_result)

# no correlation
correlation_result <- cor.test(asdata$sod, asdata$hmwPAH, method = "pearson")
print(correlation_result)

# no correlation
correlation_result <- cor.test(asdata$sod, asdata$PAH16, method = "pearson")
print(correlation_result)

```

## sumPCB
```{r}

# correlation= 0.1557987 with a p-value= .0059. This is a significant weak correlation.
correlation_result <- cor.test(asdata$sod, asdata$sumPCB, method = "pearson")
print(correlation_result)
```

## mercury, arsenic, cadmium, copper, lead and zinc
```{r}

# no correlation
correlation_result <- cor.test(asdata$sod, asdata$mercury, method = "pearson")
print(correlation_result)

# no correlation
correlation_result <- cor.test(asdata$sod, asdata$arsenic, method = "pearson")
print(correlation_result)

# no correlation
correlation_result <- cor.test(asdata$sod, asdata$cadmium, method = "pearson")
print(correlation_result)

# no correlation
correlation_result <- cor.test(asdata$sod, asdata$copper, method = "pearson")
print(correlation_result)

# no correlation
correlation_result <- cor.test(asdata$sod, asdata$lead, method = "pearson")
print(correlation_result)

# no correlation
correlation_result <- cor.test(asdata$sod, asdata$zinc, method = "pearson")
print(correlation_result)

```

## other summed analytes
```{r}

# correlation= 0.1542415 with a p-value= 0.006421. This is a significant weak correlation.
correlation_result <- cor.test(sdata$sod, sdata$Sum40CBs, method = "pearson")
print(correlation_result)

# no correlation
correlation_result <- cor.test(sdata$sod, sdata$SumBDEs, method = "pearson")
print(correlation_result)

# no correlation
correlation_result <- cor.test(sdata$sod, sdata$SumCHLDs, method = "pearson")
print(correlation_result)

# correlation= 0.1228194 with a p-value= 0.03036. This is a significant weak correlation.
correlation_result <- cor.test(sdata$sod, sdata$SumDDTs, method = "pearson")
print(correlation_result)

# correlation= 0.1150957 with a p-value= 0.04253. This is a significant weak correlation.
correlation_result <- cor.test(sdata$sod, sdata$SumHCHs, method = "pearson")
print(correlation_result)

```