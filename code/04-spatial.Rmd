---
title: "04- Spatial Analysis of Biomarkers"
output:
  html_document: 
    fig_width: 8
  pdf_document: 
    fig_width: 8
    fig_height: 5
---


# Directory and doc rules

```{r, setup, eval=TRUE, include=TRUE}

knitr::opts_chunk$set(
  echo = TRUE,         # Display code chunks
  eval = TRUE,         # Evaluate code chunks
  warning = FALSE,     # Hide warnings
  message = FALSE,     # Hide messages
  fig.width = 8,       # Set plot width in inches
  fig.height = 5,      # Set plot height in inches
  fig.align = "center" # Align plots to the center
)

```

# Load packages

```{r, eval= FALSE}

library(tidyr)
library(tidyverse)
library(ggplot2)
library(vegan)

```

# Load data

```{r}

getwd()
#data has all sites, coordinates, p450, sod, condition factor, economic factor data
data<- read.csv("/Users/cmantegna/Documents/WDFWmussels/data/biomarkerfull.csv")

#ana<- read.csv("/Users/cmantegna/Documents/Biomarker Data Analysis/PAHanalytes.csv")

```

# Review setup

```{r}

str(data)

```

# Data type and summary

## Note

Weight = g\
Length, width, height = mm\
p450, SOD = activity/ (mg/protein)\
Condition factor, economic factor = unitless

```{r}
# the data types are based in str() results, make numeric anything with na in the column.
summary(data)
```

# Take this out, this is for the analytes document. Repeat for ana
```{r}
#str(ana)

#summary(ana)

```

# The following spatial analyses require normally distributed data or something close so I am log- transforming to try to attain that.
## The base code/ concepts came from this repo: https://github.com/spcanelon/geospatial-learning?tab=readme-ov-file
```{r}
#trying out some spatial techniques for the biomarkers. If I want to use the MORAN I, I need to have normally distributed data and I do not. 
#Log transform my SOD data to try to make it normal.

# Create new variable that is the log-transformed 
logdata <- log(data$SOD)

# Histogram
hist(logdata)

# Boxplot
boxplot(logdata, horizontal = TRUE)
```



# Try to run the Moran with code from: 
```{r}
#install.packages(spdep)
#install.packages("/Users/cmantegna/Downloads/spdep_1.2-8.tar.gz", repos = NULL, type = "source")

library(sf)
library(spdep)

```
