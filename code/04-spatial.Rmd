---
title: "02- Basic Statistics"
output:
  html_document: 
    fig_width: 8
  pdf_document: 
    fig_width: 8
    fig_height: 5
---


# Directory and doc rules

```{r, setup, eval=TRUE, include=TRUE}

knitr::opts_chunk$set(
  echo = TRUE,         # Display code chunks
  eval = TRUE,         # Evaluate code chunks
  warning = FALSE,     # Hide warnings
  message = FALSE,     # Hide messages
  fig.width = 8,       # Set plot width in inches
  fig.height = 5,      # Set plot height in inches
  fig.align = "center" # Align plots to the center
)

```

# Load packages

```{r, eval= FALSE}

library(tidyr)
library(tidyverse)
library(ggplot2)
library(vegan)

```

# Load data

```{r}

getwd()
#data has all sites, coordinates, p450, sod, condition factor, economic factor data
data<- read.csv("/Users/cmantegna/Documents/WDFWmussels/data/biomarkerfull.csv")

ana<- read.csv("/Users/cmantegna/Documents/Biomarker Data Analysis/PAHanalytes.csv")

```

# Review setup

```{r}

str(data)

```

# Data type and summary

## Note

Weight = g\
Length, width, height = mm\
p450, SOD = activity/ (mg/protein)\
Condition factor, economic factor = unitless

```{r}
# the data types are based in str() results, make numeric anything with na in the column.
summary(data)
```

# Repeat for ana
```{r}
str(ana)

summary(ana)

```

```{r}
#trying out some spatial techniques for the biomarkers. If I want to use the MORAN I, I need to have normally distributed data and I do not. 
#Log transform my SOD data to try to make it normal.

# Create new variable that is the log-transformed 
logdata <- log(data$SOD)

# Histogram
hist(logdata)

# Boxplot
boxplot(logdata, horizontal = TRUE)
```


# SKIP on the rerun
```{r}
#remove values below zero by making them 0
#check that this method makes sense in the future analysis
data$SOD <- ifelse(data$SOD <= 0, 0, data$SOD)

#get rid of the SOD values that are 0
data <- data[data$SOD != 0, ]

```

# DO NOT RUN
# Rerun the log transformation to see if it cleans up the SOD data
```{r}
# Create new variable that is the log-transformed incidence rate
logdata <- log(data$SOD)

# Histogram
hist(logdata)

# Boxplot
boxplot(logdata, horizontal = TRUE)

#that made it worse, so I'm going to go back to the log transformation without removing the SOD values below 0 and try to run the code again.
```
# Try to run the Moran with code from: 
```{r}
#install.packages(spdep)
library(ggplot2)
library(sf)
library(spdep)

```
# trying Moran
```{r}

```


# 0's and negative number management

SOD values that are negative are changed to 0 signifying that the value was undetectable.\
p450 values that are 0 are missing, not actual 0's.They are thrown out.\
Note: must address the SOD values, 0's skew the data so some kind of replacement or adjustment must be made.

```{r}

#get rid of the p450 values that are 0
mdata <- mdata[mdata$p450 != 0, ]

#change negative numbers to 0 to indicate not detectable
mdata$SOD <- ifelse(mdata$SOD <= 0, 0, mdata$SOD)

```
